<!DOCTYPE html>
<html class="loading" lang="en" data-textdirection="ltr">
<!-- BEGIN: Head-->

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6EJRXTPH3Z"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6EJRXTPH3Z');
    </script>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta name="description" content="PixelPlush is a Game Studio started by Maaya and Instafluff building feel-good, relaxing and fun games">
    <meta name="keywords" content="pixelplush, game, development, studio, instafluff, maaya, art, web, dev, fun, relax, play">
    <meta name="author" content="PixelPlush">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:description" content="PixelPlush is a Game Studio started by Maaya and Instafluff building feel-good, relaxing and fun games">
    <meta name="twitter:image" content="https://www.pixelplush.dev/public/app-assets/images/logo/silhouette.png">
    <meta name="twitter:creator" content="PixelPlushGames">
    <meta name="twitter:title" content="PixelPlush Studio - Games to Relax and Play Made By Maaya and Instafluff">
    <meta property="og:type" content="website">
    <meta property="og:description" content="PixelPlush is a Game Studio started by Maaya and Instafluff building feel-good, relaxing and fun games">
    <meta property="og:image" content="https://www.pixelplush.dev/public/app-assets/images/logo/silhouette.png">
    <meta property="og:url" content="https://www.pixelplush.dev">
    <!-- <meta property="og:title" content="PixelPlush Studio - Games to Relax and Play Made By Maaya and Instafluff"> -->
    <title>Goodies Market - PixelPlush Studio - Games to Relax and Play Made By Maaya and Instafluff</title>
    <!-- <link rel="apple-touch-icon" href="public/app-assets/images/ico/apple-icon-120.png"> -->
    <link rel="shortcut icon" type="image/x-icon" href="public/app-assets/images/ico/favicon.ico">
    <link href="https://fonts.googleapis.com/css?family=Rubik:300,400,500,600%7CIBM+Plex+Sans:300,400,500,600,700" rel="stylesheet">

    <!-- BEGIN: Vendor CSS-->
    <link rel="stylesheet" type="text/css" href="public/app-assets/vendors/css/vendors.min.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/vendors/css/extensions/toastr.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/vendors/css/forms/spinner/jquery.bootstrap-touchspin.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/vendors/css/charts/apexcharts.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/vendors/css/extensions/swiper.min.css">
    <!-- END: Vendor CSS-->

    <!-- BEGIN: Theme CSS-->
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/bootstrap-extended.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/colors.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/components.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/themes/dark-layout.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/themes/semi-dark-layout.css">
    <!-- END: Theme CSS-->

    <!-- BEGIN: Page CSS-->
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/core/menu/menu-types/vertical-menu.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/pages/dashboard-ecommerce.css">
    <link rel="stylesheet" type="text/css" href="public/app-assets/css/plugins/extensions/toastr.min.css">
    <!-- END: Page CSS-->

    <!-- BEGIN: Custom CSS-->
    <link rel="stylesheet" type="text/css" href="public/assets/css/style.css">
    <!-- END: Custom CSS-->

</head>
<!-- END: Head-->

<!-- BEGIN: Body-->

<body class="vertical-layout vertical-menu-modern 1-column  navbar-sticky footer-static  fixed-footer" data-open="click" data-menu="vertical-menu-modern" data-col="1-column">

    <!-- BEGIN: Header-->
    <div class="header-navbar-shadow"></div>
    <nav class="header-navbar main-header-navbar navbar-expand-lg navbar navbar-with-menu fixed-top ">
        <div class="navbar-wrapper">
            <div class="navbar-container content">
                <div class="navbar-collapse" id="navbar-mobile">
                    <div class="mr-auto float-left bookmark-wrapper d-flex align-items-center">
                        <ul class="nav navbar-nav">
                            <li class="nav-item mr-auto">
                                <div class="navbar-brand">
                                    <a href="index.html">
                                        <img src="public/app-assets/images/logo/logo.png" height="27px" class="img-responsive"> <img src="public/app-assets/images/logo/text.png" height="27px" class="img-responsive">
                                    </a>
                                    <span class="font-small-3"><i class="bx bxs-heart pink mx-50 font-small-3"></i>By <a href="https://twitch.tv/maayainsane" target="_blank"><img src="public/app-assets/images/icon/maaya.gif" height="32px"> Maaya</a> &amp; <a href="https://twitch.tv/instafluff" target="_blank">Instafluff <img src="public/app-assets/images/icon/instafluff.gif" height="34px"></a></span>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <ul class="nav navbar-nav float-right d-flex align-items-center">
                        <li class="nav-item d-lg-block not-logged-in">
                            <div class="not-logged-in">
                                <a id="login" href="login.html?redirect=market.html" class="btn btn-primary mr-25">Log In</a>
                            </div>
                        </li>
                        <!-- <li class="dropdown dropdown-notification nav-item"><a class="nav-link nav-link-label" href="#" data-toggle="dropdown"><i class="ficon bx bx-bell bx-tada bx-flip-horizontal"></i><span class="badge badge-pill badge-danger badge-up">5</span></a>
                            <ul class="dropdown-menu dropdown-menu-media dropdown-menu-right">
                                <li class="dropdown-menu-header">
                                    <div class="dropdown-header px-1 py-75 d-flex justify-content-between"><span class="notification-title">7 new Notification</span><span class="text-bold-400 cursor-pointer">Mark all as read</span></div>
                                </li>
                                <li class="scrollable-container media-list"><a class="d-flex justify-content-between" href="javascript:void(0)">
                                        <div class="media d-flex align-items-center">
                                            <div class="media-left pr-0">
                                                <div class="avatar mr-1 m-0"><img src="../../../app-assets/images/portrait/small/avatar-s-11.jpg" alt="avatar" height="39" width="39"></div>
                                            </div>
                                            <div class="media-body">
                                                <h6 class="media-heading"><span class="text-bold-500">Congratulate Socrates Itumay</span> for work anniversaries</h6><small class="notification-text">Mar 15 12:32pm</small>
                                            </div>
                                        </div>
                                    </a>
                                    <div class="d-flex justify-content-between read-notification cursor-pointer">
                                        <div class="media d-flex align-items-center">
                                            <div class="media-left pr-0">
                                                <div class="avatar mr-1 m-0"><img src="../../../app-assets/images/portrait/small/avatar-s-16.jpg" alt="avatar" height="39" width="39"></div>
                                            </div>
                                            <div class="media-body">
                                                <h6 class="media-heading"><span class="text-bold-500">New Message</span> received</h6><small class="notification-text">You have 18 unread messages</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between cursor-pointer">
                                        <div class="media d-flex align-items-center py-0">
                                            <div class="media-left pr-0"><img class="mr-1" src="../../../app-assets/images/icon/sketch-mac-icon.png" alt="avatar" height="39" width="39"></div>
                                            <div class="media-body">
                                                <h6 class="media-heading"><span class="text-bold-500">Updates Available</span></h6><small class="notification-text">Sketch 50.2 is currently newly added</small>
                                            </div>
                                            <div class="media-right pl-0">
                                                <div class="row border-left text-center">
                                                    <div class="col-12 px-50 py-75 border-bottom">
                                                        <h6 class="media-heading text-bold-500 mb-0">Update</h6>
                                                    </div>
                                                    <div class="col-12 px-50 py-75">
                                                        <h6 class="media-heading mb-0">Close</h6>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between cursor-pointer">
                                        <div class="media d-flex align-items-center">
                                            <div class="media-left pr-0">
                                                <div class="avatar bg-primary bg-lighten-5 mr-1 m-0 p-25"><span class="avatar-content text-primary font-medium-2">LD</span></div>
                                            </div>
                                            <div class="media-body">
                                                <h6 class="media-heading"><span class="text-bold-500">New customer</span> is registered</h6><small class="notification-text">1 hrs ago</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="cursor-pointer">
                                        <div class="media d-flex align-items-center justify-content-between">
                                            <div class="media-left pr-0">
                                                <div class="media-body">
                                                    <h6 class="media-heading">New Offers</h6>
                                                </div>
                                            </div>
                                            <div class="media-right">
                                                <div class="custom-control custom-switch">
                                                    <input class="custom-control-input" type="checkbox" checked id="notificationSwtich">
                                                    <label class="custom-control-label" for="notificationSwtich"></label>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between cursor-pointer">
                                        <div class="media d-flex align-items-center">
                                            <div class="media-left pr-0">
                                                <div class="avatar bg-danger bg-lighten-5 mr-1 m-0 p-25"><span class="avatar-content"><i class="bx bxs-heart text-danger"></i></span></div>
                                            </div>
                                            <div class="media-body">
                                                <h6 class="media-heading"><span class="text-bold-500">Application</span> has been approved</h6><small class="notification-text">6 hrs ago</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between read-notification cursor-pointer">
                                        <div class="media d-flex align-items-center">
                                            <div class="media-left pr-0">
                                                <div class="avatar mr-1 m-0"><img src="../../../app-assets/images/portrait/small/avatar-s-4.jpg" alt="avatar" height="39" width="39"></div>
                                            </div>
                                            <div class="media-body">
                                                <h6 class="media-heading"><span class="text-bold-500">New file</span> has been uploaded</h6><small class="notification-text">4 hrs ago</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between cursor-pointer">
                                        <div class="media d-flex align-items-center">
                                            <div class="media-left pr-0">
                                                <div class="avatar bg-rgba-danger m-0 mr-1 p-25">
                                                    <div class="avatar-content"><i class="bx bx-detail text-danger"></i></div>
                                                </div>
                                            </div>
                                            <div class="media-body">
                                                <h6 class="media-heading"><span class="text-bold-500">Finance report</span> has been generated</h6><small class="notification-text">25 hrs ago</small>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="d-flex justify-content-between cursor-pointer">
                                        <div class="media d-flex align-items-center border-0">
                                            <div class="media-left pr-0">
                                                <div class="avatar mr-1 m-0"><img src="../../../app-assets/images/portrait/small/avatar-s-16.jpg" alt="avatar" height="39" width="39"></div>
                                            </div>
                                            <div class="media-body">
                                                <h6 class="media-heading"><span class="text-bold-500">New customer</span> comment recieved</h6><small class="notification-text">2 days ago</small>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                                <li class="dropdown-menu-footer"><a class="dropdown-item p-50 text-primary justify-content-center" href="javascript:void(0)">Read all notifications</a></li>
                            </ul>
                        </li> -->
                        <li class="dropdown dropdown-user nav-item logged-in">
                            <a class="dropdown-toggle nav-link dropdown-user-link" href="#" data-toggle="dropdown">
                                <div class="user-nav d-lg-flex d-none"><span class="user-name">Not Logged In</span><span class="user-status"><img class="pixelated" src="public/app-assets/images/icon/plush_coin.gif" height="18px" /> <strong><span class="user-coins"></span></strong></span> </div><span class="avatar"><img class="round account-image" src="public/app-assets/images/icon/icons8-cat-profile-64.png" alt="User Profile Image" height="40" width="40"><span class="avatar-status-online"></span></span>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right pb-0">
                                <a class="dropdown-item" href="customize.html"><i class="bx bx-user mr-50"></i> My Dressing Room</a>
                                <a class="dropdown-item" href="transactions.html"><i class="bx bx-check-square mr-50"></i> My Shopping History</a>
                                <a class="dropdown-item" href="market.html"><i class="bx bx-cart mr-50"></i> Goodies Market</a>
                                <a class="dropdown-item" href="https://pixelplush.dev/discord"><i class="bx bxl-discord mr-50"></i> PixelPlush Discord</a>
                                <a class="dropdown-item" href="redeem.html"><i class="bx bx-purchase-tag mr-50"></i> Redeem Code</a>
                                <div class="dropdown-divider mb-0"></div><a class="dropdown-item logout" href="#"><i class="bx bx-power-off mr-50"></i> Logout</a>
                            </div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>
    <!-- END: Header-->

    <!-- BEGIN: Content-->
    <div class="app-content content">
        <div class="content-overlay"></div>
        <div class="content-wrapper">
            <div class="content-header row">
            </div>
            <div class="content-body">
                <section class="users-edit">
                    <div class="row">
                        <div class="col-12">
                            <div class="row">
                                <!-- left menu section -->
                                <div class="col-md-3 mb-2 mb-md-0 pills-stacked">
                                    <ul class="nav nav-pills flex-column">
                                        <li class="nav-item">
                                            <a class="nav-link d-flex align-items-center" href="index.html">
                                                <i class="bx bx-home"></i>
                                                <span>PixelPlush Home</span>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link d-flex align-items-center" href="twitch.html">
                                                <i class="bx bxl-twitch"></i>
                                                <span>Games for Twitch</span>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link d-flex align-items-center" href="scores.html">
                                                <i class="bx bx-list-ol"></i>
                                                <span>Top Scores</span>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link d-flex align-items-center active" href="market.html">
                                                <img src="public/app-assets/images/icon/plush_coin.gif" height="20px" class="pixelated" />
                                                <span>Goodies Market</span>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link d-flex align-items-center" href="customize.html">
                                                <i class="bx bx-user"></i>
                                                <span>My Dressing Room</span>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link d-flex align-items-center" href="playground.html">
                                                <i class="bx bx-sun"></i>
                                                <span>Pet Playground</span>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link d-flex align-items-center" href="transactions.html">
                                                <i class="bx bx-check-square"></i>
                                                <span>My Shopping History</span>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link d-flex align-items-center" href="links.html">
                                                <i class="bx bx-link"></i>
                                                <span>Follow Us!</span>
                                            </a>
                                        </li>
                                        <li class="nav-item">
                                            <a class="nav-link d-flex align-items-center" href="beta.html">
                                                <i class="bx bxl-twitch"></i>
                                                <span>Beta Testing Area</span>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                                <!-- right content section -->
                                <div class="col-md-9">
                                    <div class="card">
                                        <div class="card-content">
                                            <div class="card-body">
                                                <div class="tab-content">
                                                    <div class="tab-pane active" id="account" aria-labelledby="account-tab" role="tabpanel">
                                                        <!-- users edit media object start -->
                                                        <div class="media">
                                                            <div class="media-body">
                                                                <div class="row">
                                                                    <div class="col-2">
                                                                        <span>Your Wallet:</span>
                                                                        <h2 class="media-heading"><img class="pixelated" src="public/app-assets/images/icon/plush_coin.gif" height="32px" /> <strong><span class="user-coins"></span></strong></h2>
                                                                        <!-- <div class="col-12 px-0 d-flex">
                                                                            <a id="login" href="login.html" class="btn btn-sm btn-primary mr-25 not-logged-in">Log In</a>
                                                                            <a href="#" class="btn btn-sm btn-light-secondary logged-in logout">Logout</a>
                                                                        </div> -->
                                                                    </div>
                                                                    <div class="col-10">
                                                                        <div class="row">
                                                                            <div class="col-sm-2 col-2">
                                                                                <button class="btn btn-dark" type="button" id="buy-btn-10" onclick="showCoinBuy(10, 2)"><small><img src="public/app-assets/images/icon/plush_coin.gif" height="20px" class="pixelated" /> x10</small><br/><strong>$2</strong></button>
                                                                            </div>
                                                                            <div class="col-sm-2 col-2">
                                                                                <button class="btn btn-warning" type="button" id="buy-btn-30" onclick="showCoinBuy(20, 4)"><small><img src="public/app-assets/images/icon/plush_coin.gif" height="20px" class="pixelated" /> x20</small><br/><strong>$4</strong></button>
                                                                            </div>
                                                                            <div class="col-sm-2 col-2">
                                                                                <button class="btn btn-danger" type="button" id="buy-btn-60" onclick="showCoinBuy(40, 8)"><small><img src="public/app-assets/images/icon/plush_coin.gif" height="20px" class="pixelated" /> x40</small><br/><strong>$8</strong></button>
                                                                            </div>
                                                                            <div class="col-sm-2 col-2">
                                                                                <button class="btn btn-success" type="button" id="buy-btn-100" onclick="showCoinBuy(100, 20)"><small><img src="public/app-assets/images/icon/plush_coin.gif" height="20px" class="pixelated" /> x100</small><br/><strong>$20</strong></button>
                                                                            </div>
                                                                            <div class="col-sm-2 col-2">
                                                                                <button class="btn btn-info" type="button" id="buy-btn-500" onclick="showCoinBuy(500, 100)"><small><img src="public/app-assets/images/icon/plush_coin.gif" height="20px" class="pixelated" /> x500</small><br/><strong>$100</strong></button>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                    <!--info theme Modal -->
                                                                    <div class="modal fade text-left show" id="coin-buy" tabindex="-1" role="dialog" aria-labelledby="plushcoin-buy" aria-modal="true">
                                                                        <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable" role="document">
                                                                            <div class="modal-content">
                                                                                <div class="modal-header bg-warning">
                                                                                    <h5 class="modal-title white" id="plushcoin-buy"><img src="public/app-assets/images/icon/plush_coin.gif" height="40px" class="pixelated" /> x <span id="coin-buy-amount"></span> Plush Coins!</h5>
                                                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                                        <i class="bx bx-x"></i>
                                                                                    </button>
                                                                                </div>
                                                                                <div class="modal-body">
                                                                                    <h4 id="coin-buy-text"></h4>
                                                                                    <div class="px-5 py-2">
                                                                                        <div id="paypal-button-container"></div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="modal-footer">
                                                                                    Use Plush Coins on special characters and pets!
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <!-- users edit media object ends -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card">
                                        <div class="card-content">
                                            <div class="card-body">
                                                <div class="row">
                                                    <div class="col-4">
                                                        <div class="custom-control custom-checkbox">
                                                            <input type="checkbox" class="custom-control-input bg-primary" checked="" name="customCheck" id="checkboxChars">
                                                            <label class="custom-control-label" for="checkboxChars">Characters</label>
                                                        </div>
                                                        <div class="custom-control custom-checkbox">
                                                            <input type="checkbox" class="custom-control-input bg-warning" checked="" name="customCheck" id="checkboxPets">
                                                            <label class="custom-control-label" for="checkboxPets">Pets</label>
                                                        </div>
                                                    </div>
                                                    <div class="col-8">
                                                        <div class="input-group">
                                                            <div class="input-group-prepend">
                                                                <span class="input-group-text"><i class="bx bx-search"></i></span>
                                                            </div>
                                                            <input id="market-search" type="text" class="form-control">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div id="catalog-list" class="row">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>
    <!-- END: Content-->

    </div>
    <div class="sidenav-overlay"></div>
    <div class="drag-target"></div>

    <!-- BEGIN: Footer-->
    <footer class="footer footer-static footer-light">
        <!-- <li class="nav-item d-none d-lg-block"></li> -->
        <p class="clearfix mb-0"><span class="float-left d-inline-block"><i class="bx bxl-discord"></i> Join our Discord and hang out with us!<a href="https://pixelplush.dev/discord" target="_blank"><u>https://pixelplush.dev/discord</u></a></span>
          <span class="float-right d-inline-block"><a href="terms.html">TERMS OF USE</a> | <a href="terms.html">PRIVACY</a> | <script>document.write(new Date().getFullYear());</script> &copy; PIXELPLUSH&trade;</span>
            <button class="btn btn-primary btn-icon scroll-top" type="button"><i class="bx bx-up-arrow-alt"></i></button>
        </p>
    </footer>
    <!-- END: Footer-->


    <!-- BEGIN: Vendor JS-->
    <script src="public/app-assets/vendors/js/vendors.min.js"></script>
    <script src="public/app-assets/fonts/LivIconsEvo/js/LivIconsEvo.tools.js"></script>
    <script src="public/app-assets/fonts/LivIconsEvo/js/LivIconsEvo.defaults.js"></script>
    <script src="public/app-assets/fonts/LivIconsEvo/js/LivIconsEvo.min.js"></script>
    <!-- BEGIN Vendor JS-->

    <!-- BEGIN: Page Vendor JS-->
    <script src="public/app-assets/vendors/js/charts/apexcharts.min.js"></script>
    <script src="public/app-assets/vendors/js/extensions/swiper.min.js"></script>
    <script src="public/app-assets/vendors/js/forms/spinner/jquery.bootstrap-touchspin.js"></script>
    <script src="public/app-assets/vendors/js/extensions/toastr.min.js"></script>
    <script src="public/app-assets/vendors/js/extensions/sweetalert2.all.min.js"></script>
    <!-- END: Page Vendor JS-->

    <!-- BEGIN: Theme JS-->
    <script src="public/app-assets/js/scripts/configs/vertical-menu-light.js"></script>
    <script src="public/app-assets/js/core/app-menu.js"></script>
    <script src="public/app-assets/js/core/app.js"></script>
    <script src="public/app-assets/js/scripts/components.js"></script>
    <script src="public/app-assets/js/scripts/footer.js"></script>
    <!-- END: Theme JS-->

    <script src="public/app-assets/js/scripts/forms/number-input.js"></script>

    <script
    src="https://www.paypal.com/sdk/js?client-id=Ac8ThQDkE1sBoHpJD4cgrd4nEyF0gYuUzQwNzSolvCVjGondlvAYy7mlQdFaV5RpspBzBFjnn9Mt8dep"></script>
    <script src="public/comfytwitch.min.js"></script>
    <script>
        const params = new URLSearchParams( location.search );
        const clientId = "8m07ghhogjy0q09moeunnpdu51i60n";
        const baseUrl = window.location.origin;
        const plushApiUrl = "https://api.pixelplush.dev/v1"; //"http://localhost:3000/v1";
        let twitch = {};
        let account = {};
        let catalog = {};
        let items = {};
        let animationTimer = null;
        let animationFrame = 0;
        let subReference = {
            "83118047": "instafluff",
            "29788274": "maayainsane",
        };
        let twitchSubs = {};

        $( ".not-logged-in" ).show();
        $( ".logged-in" ).hide();

        ComfyTwitch.Check()
        .then( async result => {
            // console.log( result );
            if( result ) {
                try {
                    account = await fetch( `${plushApiUrl}/accounts`, {
                        headers: {
                            Twitch: result.token
                        }
                    } ).then( r => r.json() );

                    // console.log( account );

                    if( account.error ) {
                        throw "Login Error";
                    }

                    $( ".not-logged-in" ).hide();
                    $( ".logged-in" ).show();

                    $( ".account-image" ).attr( "src", account.profileImage );
                    $( ".user-name" ).text( account.displayName || account.username );
                    $( ".user-coins" ).text( account.coins );

                    if( ComfyTwitch.Scopes.includes( "user_subscriptions" ) ) {
                        for( let channel in subReference ) {
                            let subCheck = await fetch( `https://api.twitch.tv/kraken/users/${account.platformId}/subscriptions/${channel}`, {
                                headers: {
                                    Accept: "application/vnd.twitchtv.v5+json",
                                    "Client-ID": clientId,
                                    Authorization: `OAuth ${result.token}`
                                }
                            } ).then( r => r.json() );
                            twitchSubs[ subReference[ channel ] ] = !!subCheck.sub_plan;
                        }
                    }

                    // document.querySelector( "#userid" ).innerText = r.key;
                }
                catch( error ) {
                    // TODO: Auth Failed
                    console.log( "Auth Validate Failed", error );
                    toastr.error( error, "Authentication Error", { positionClass:"toast-bottom-right", containerId:"toast-bottom-right" } );
                }
            }
            else {
                $( ".not-logged-in" ).show();
                $( ".logged-in" ).hide();
            }

            catalog = await fetch( "https://www.pixelplush.dev/assets/catalog.json", {
            }).then( r => r.json() );

            // catalog = catalog.filter( x => !x.hidden );

            // console.log( catalog );

            catalog.forEach( x => {
                items[ x.id ] = x;
            });

            // console.log( items );

            // Populate Catalog
            // $( "#inputItemList" ).empty();

            // inputItemList
            populateItemList();

            $( ".logout" ).on( "click", function() {
                ComfyTwitch.Logout();
                window.location.reload();
            });
        });

        $( document ).ready(function() {
             $( "#market-search" ).on( "input", ( e ) => {
                 populateItemList( e.target.value );
             });
             $( "#checkboxChars" ).on( "change", ( e ) => {
                 populateItemList( $( "#market-search" ).val() );
             });
             $( "#checkboxPets" ).on( "change", ( e ) => {
                 populateItemList( $( "#market-search" ).val() );
             });
        });

        function populateItemList( searchText = "" ) {
            $( "#catalog-list" ).empty();
            let filteredCatalog = catalog.filter( x => x.id.includes( searchText ) || x.theme.toLowerCase().includes( searchText ) );
            if( !$( "#checkboxChars" ).prop( "checked" ) ) {
                filteredCatalog = filteredCatalog.filter( x => x.type !== "character" );
            }
            if( !$( "#checkboxPets" ).prop( "checked" ) ) {
                filteredCatalog = filteredCatalog.filter( x => x.type !== "pet" );
            }

            // Handle adding subscription items
            filteredCatalog.filter( x => !!x.subscription ).forEach( ( item, index ) => {
                let typeBG = "primary";
                switch( item.type ) {
                    case "character":
                        typeBG = "primary";
                        break;
                    case "pet":
                        typeBG = "danger";
                        break;
                    default:
                        typeBG = "primary";
                        break;
                }
                // console.log( item );
                if( twitchSubs[ item.subscription.toLowerCase() ] ) {
                    $( "#catalog-list" ).append( `
                        <div class="col-sm-3 col-6">
                          <div id="item_${item.id}" class="card text-center bg-dark bg-light">
                            <div class="card-content">
                              <div class="card-body py-1">
                                <div class="badge-circle badge-circle-xlg badge-circle-light-${typeBG} mx-auto mb-50">
                                  <img id="item_${item.id}_preview" class="pixelated item-scale" src="${getItemPreview( item.id, 0 )}"/>
                                </div>
                                <div class="text-muted line-ellipsis"><small>${item.type}</small></div>
                                <h5 class="mb-0">${item.name}</h5>
                                <div class="pt-1">
                                    <button class="btn btn-sm btn-outline-secondary" type="button" disabled><i class="bx bxl-twitch font-medium-3"></i> <strong>Owned</strong></button>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                    `);
                }
                else {
                    $( "#catalog-list" ).append( `
                        <div class="col-sm-3 col-6">
                          <div id="item_${item.id}" class="card text-center bg-purple">
                            <div class="card-content">
                              <div class="card-body py-1">
                                <div class="badge-circle badge-circle-xlg badge-circle-light-${typeBG} mx-auto mb-50">
                                  <img id="item_${item.id}_preview" class="pixelated item-scale" src="${getItemPreview( item.id, 0 )}"/>
                                </div>
                                <div class="text-muted line-ellipsis"><small>${item.type}</small></div>
                                <h5 class="mb-0">${item.name}</h5>
                                <div class="pt-1">
                                    <button class="btn btn-sm btn-twitch" type="button" onclick="verifySub('${item.id}')"><i class="bx bxl-twitch font-medium-3"></i> <strong>${item.subscription}</strong></button>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                    `);
                }
            });

            filteredCatalog.forEach( ( item, index ) => {
                let typeBG = "primary";
                switch( item.type ) {
                    case "character":
                        typeBG = "primary";
                        break;
                    case "pet":
                        typeBG = "danger";
                        break;
                    default:
                        typeBG = "primary";
                        break;
                }
                if( account && account.owned && account.owned.includes( item.id ) ) {
                    if( item.hidden ) {
                        $( "#catalog-list" ).append( `
                            <div class="col-sm-3 col-6">
                              <div id="item_${item.id}" class="card text-center bg-dark bg-light">
                                <div class="card-content">
                                  <div class="card-body py-1">
                                    <div class="badge-circle badge-circle-xlg badge-circle-light-${typeBG} mx-auto mb-50">
                                      <img id="item_${item.id}_preview" class="pixelated item-scale" src="${getItemPreview( item.id, 0 )}"/>
                                    </div>
                                    <div class="text-muted line-ellipsis"><small>${item.type}</small></div>
                                    <h5 class="mb-0">${item.name}</h5>
                                    <div class="pt-1">
                                        <button class="btn btn-sm btn-outline-secondary" type="button" disabled><strong>Owned</strong></button>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                        `);
                    }
                    else {
                        $( "#catalog-list" ).append( `
                            <div class="col-sm-3 col-6">
                              <div id="item_${item.id}" class="card text-center bg-dark bg-light">
                                <div class="card-content">
                                  <div class="card-body py-1">
                                    <div class="badge-circle badge-circle-xlg badge-circle-light-${typeBG} mx-auto mb-50">
                                      <img id="item_${item.id}_preview" class="pixelated item-scale" src="${getItemPreview( item.id, 0 )}"/>
                                    </div>
                                    <div class="text-muted line-ellipsis"><small>${item.type}</small></div>
                                    <h5 class="mb-0">${item.name}</h5>
                                    <div class="pt-1">
                                        <button class="btn btn-sm btn-outline-secondary" type="button" disabled><img src="public/app-assets/images/icon/plush_coin.gif" height="20px" class="pixelated" /> <strong>${item.sale ? `<span class="strikeout">${item.cost}</span> -> ` : ""}${item.cost === 0 ? "FREE" : ( item.sale ? `<span class="text-secondary">${item.cost / 2}</span>` : item.cost )}</strong></button>
                                        <button class="btn btn-sm btn-outline-secondary" type="button" onclick="giftItem('${item.id}')"><img src="https://www.pixelplush.dev/assets/items/gift_smal_redl.png" height="20px" class="pixelated" /> <strong>${item.sale ? `<span class="strikeout">${item.cost}</span> -> ` : ""}${item.cost === 0 ? "FREE" : ( item.sale ? `<span class="text-secondary">${item.cost / 2}</span>` : item.cost )}</strong></button>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                        `);
                    }
                }
                else if( !item.hidden ) {
                    $( "#catalog-list" ).append( `
                        <div class="col-sm-3 col-6">
                          <div id="item_${item.id}" class="card text-center">
                            <div class="card-content">
                              <div class="card-body py-1">
                                <div class="badge-circle badge-circle-xlg badge-circle-light-${typeBG} mx-auto mb-50">
                                  <img id="item_${item.id}_preview" class="pixelated item-scale" src="${getItemPreview( item.id, 0 )}"/>
                                </div>
                                <div class="text-muted line-ellipsis"><small>${item.type}</small></div>
                                <h5 class="mb-0">${item.name}</h5>
                                <div class="pt-1">
                                    <button class="btn btn-sm btn-outline-primary" type="button" onclick="buyItem('${item.id}')"><img src="public/app-assets/images/icon/plush_coin.gif" height="20px" class="pixelated" /> <strong>${item.sale ? `<span class="strikeout">${item.cost}</span> -> ` : ""}${item.cost === 0 ? "FREE" : ( item.sale ? `<span class="text-success">${item.cost / 2}</span>` : item.cost )}</strong></button>
                                    <button class="btn btn-sm btn-outline-primary" type="button" onclick="giftItem('${item.id}')"><img src="https://www.pixelplush.dev/assets/items/gift_smal_redl.png" height="20px" class="pixelated" /> <strong>${item.sale ? `<span class="strikeout">${item.cost}</span> -> ` : ""}${item.cost === 0 ? "FREE" : ( item.sale ? `<span class="text-secondary">${item.cost / 2}</span>` : item.cost )}</strong></button>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                    `);
                }

                $( `#item_${item.id}` ).hover( function() {
                    if( animationTimer ) {
                        clearInterval( animationTimer );
                    }
                    animationTimer = setInterval( () => {
                        animationFrame++;
                        let preview = getItemPreview( item.id, animationFrame );
                        if( document.querySelector( `#item_${item.id}_preview` ) ) {
                            document.querySelector( `#item_${item.id}_preview` ).setAttribute( "src", preview );
                        }
                    }, 100 );
                }, function() {
                    clearInterval( animationTimer );
                    animationFrame = 0;
                    let preview = getItemPreview( item.id, 0 );
                    document.querySelector( `#item_${item.id}_preview` ).setAttribute( "src", preview );
                });
            });
        }

        function getItemPreview( itemId, frame ) {
            let item = items[ itemId ];
            let dir = "";
            switch( item.type ) {
                case "pet":
                    dir = `pets/${item.path}`;
                    break;
                case "character":
                default:
                    dir = `${item.type}s/${item.id}`;
                    break;
            }

            let animFrame = frame % 10;
            let direction = "front";
            switch( Math.floor( ( frame % 80 ) / 20 ) ) {
                case 0:
                    direction = "front";
                    break;
                case 1:
                    direction = "left";
                    break;
                case 2:
                    direction = "back";
                    break;
                case 3:
                    direction = "right";
                    break;
            }

            return `https://www.pixelplush.dev/assets/${dir}/${item.path}_${direction}/${item.path}_${direction}${animFrame + 1}.png`;
        }

        async function buyItem( itemId ) {
            try {
                let result = await Swal.fire({
                    title: `Add ${items[ itemId ].name} to your account?`,
                    text: `This will use ${Math.floor( items[ itemId ].sale ? items[ itemId ].cost / 2 : items[ itemId ].cost )} coins`,
                    // type: 'success',
                    imageUrl: `${getItemPreview( itemId, 0 )}`,
                    imageWidth: 48,
                    imageHeight: 48,
                    confirmButtonClass: 'btn btn-primary',
                    cancelButtonClass: 'btn btn-danger ml-1',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Yes!',
                    buttonsStyling: false,
                });
                if( result.value ) {
                    let result = await fetch( `${plushApiUrl}/shop/buy`, {
                        method: "POST",
                        headers: {
                            Twitch: ComfyTwitch.Token,
                        },
                        body: JSON.stringify( {
                            item: itemId
                        })
                    } ).then( r => r.json() );
                    console.log( "done!", result );
                    if( result.error ) {
                        throw result.error;
                    }
                    // window.location.reload();

                    account = await fetch( `${plushApiUrl}/accounts`, {
                        headers: {
                            Twitch: ComfyTwitch.Token
                        }
                    } ).then( r => r.json() );
                    $( ".user-coins" ).text( account.coins );
                    populateItemList();
                    toastr.success( `You got ${items[ itemId ].name}!`, "Success", { positionClass:"toast-bottom-right", containerId:"toast-bottom-right" } );
                    let confirm = await Swal.fire({
                        title: `Use ${items[ itemId ].name}?`,
                        text: `Would you like to set ${items[ itemId ].name} as your active ${items[ itemId ].type}?`,
                        // type: 'success',
                        imageUrl: `${getItemPreview( itemId, 0 )}`,
                        imageWidth: 48,
                        imageHeight: 48,
                        confirmButtonClass: 'btn btn-primary',
                        cancelButtonClass: 'btn btn-danger ml-1',
                        showCancelButton: true,
                        confirmButtonColor: '#3085d6',
                        cancelButtonColor: '#d33',
                        confirmButtonText: 'Yes!',
                        cancelButtonText: 'No',
                        buttonsStyling: false,
                    });
                    if( confirm.value ) {
                    await activateItem( itemId );
                        toastr.success( `${items[ itemId ].name} is now selected!`, "Success", { positionClass:"toast-bottom-right", containerId:"toast-bottom-right" } );
                    }
                }
            }
            catch( err ) {
                // console.log( err );
                toastr.error( err, "Error", { positionClass:"toast-bottom-right", containerId:"toast-bottom-right" } );
            }
        }

        async function verifySub( itemId ) {
            try {
                let result = await Swal.fire({
                    title: `Verify Twitch subscription to ${items[ itemId ].subscription}?`,
                    // type: 'success',
                    imageUrl: `${getItemPreview( itemId, 0 )}`,
                    imageWidth: 48,
                    imageHeight: 48,
                    confirmButtonClass: 'btn btn-twitch',
                    cancelButtonClass: 'btn btn-danger ml-1',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Yes!',
                    buttonsStyling: false,
                });
                if( result.value ) {
                    ComfyTwitch.Logout();
                    localStorage.setItem( "redirectPage", window.location.href );
                    ComfyTwitch.Login( clientId, `${baseUrl}/redirect.html`, [ "user:read:email", "user_subscriptions" ] );
                }
            }
            catch( err ) {
                // console.log( err );
                toastr.error( err, "Error", { positionClass:"toast-bottom-right", containerId:"toast-bottom-right" } );
            }
        }

        async function activateItem( itemId ) {
            try {
                console.log( itemId );
                let result = await fetch( `${plushApiUrl}/accounts/design`, {
                    method: "POST",
                    headers: {
                        Twitch: ComfyTwitch.Token,
                    },
                    body: JSON.stringify( {
                        item: itemId
                    })
                } ).then( r => r.json() );
                console.log( "activating!", result );
                if( result.error ) {
                    throw result.error;
                }
                // window.location.reload();

                account = await fetch( `${plushApiUrl}/accounts`, {
                    headers: {
                        Twitch: ComfyTwitch.Token
                    }
                } ).then( r => r.json() );
                $( ".user-coins" ).text( account.coins );
                populateItemList();
                // toastr.success( `Set to ${items[ itemId ].name}!`, "Success", { positionClass:"toast-bottom-right", containerId:"toast-bottom-right" } );
            }
            catch( err ) {
                // console.log( err );
                toastr.error( err, "Error", { positionClass:"toast-bottom-right", containerId:"toast-bottom-right" } );
            }
        }

        async function giftItem( itemId ) {
            try {
                let result = await Swal.fire({
                    title: `Create a gift code for ${items[ itemId ].name}?`,
                    text: `A gift code! This will use ${Math.floor( items[ itemId ].sale ? items[ itemId ].cost / 2 : items[ itemId ].cost )} coins`,
                    // type: 'success',
                    imageUrl: `${getItemPreview( itemId, 0 )}`,
                    imageWidth: 48,
                    imageHeight: 48,
                    confirmButtonClass: 'btn btn-primary',
                    cancelButtonClass: 'btn btn-danger ml-1',
                    showCancelButton: true,
                    confirmButtonColor: '#3085d6',
                    cancelButtonColor: '#d33',
                    confirmButtonText: 'Yes!',
                    buttonsStyling: false,
                });
                if( result.value ) {
                    let result = await fetch( `${plushApiUrl}/shop/buy`, {
                        method: "POST",
                        headers: {
                            Twitch: ComfyTwitch.Token,
                        },
                        body: JSON.stringify( {
                            item: itemId,
                            coupon: true
                        })
                    } ).then( r => r.json() );
                    console.log( "done!", result );
                    if( result.error ) {
                        throw result.error;
                    }
                    // window.location.reload();

                    account = await fetch( `${plushApiUrl}/accounts`, {
                        headers: {
                            Twitch: ComfyTwitch.Token
                        }
                    } ).then( r => r.json() );
                    $( ".user-coins" ).text( account.coins );
                    populateItemList();
                    toastr.success( `You got a code for ${items[ itemId ].name}!`, "Success", { positionClass:"toast-bottom-right", containerId:"toast-bottom-right" } );
                    Swal.fire( {
                        title: result.code,
                        html: `Ready! Here is your gift code for ${items[ itemId ].name}!<br/><br/>You can also gift it via this redeem link: <a href="https://www.pixelplush.dev/redeem.html?code=${result.code}">https://www.pixelplush.dev/redeem.html?code=${result.code}<a/>`,
                        footer: `<strong>IMPORTANT:</strong> Save this code! It will disappear after you close this notification window.`,
                        backdrop: `
                            rgba(0,0,123,0.4)
                        `,
                        // type: 'success',
                        imageUrl: `${getItemPreview( itemId, 0 )}`,
                        imageWidth: 48,
                        imageHeight: 48,
                        allowOutsideClick: false,
                        allowEscapeKey: false,
                        allowEnterKey: false,
                        confirmButtonClass: 'btn btn-danger',
                        confirmButtonColor: '#d33',
                        confirmButtonText: 'Okay, I saved it!',
                        buttonsStyling: false,
                    } );
                }
            }
            catch( err ) {
                // console.log( err );
                toastr.error( err, "Error", { positionClass:"toast-bottom-right", containerId:"toast-bottom-right" } );
            }
        }

        function showCoinBuy( coins, amount ) {
            orderAmount = coins;
            $("#coin-buy-amount").text( coins );
            $("#coin-buy-text").text( `${coins} Plush Coins for $${amount}! Exciting!` );
            $("#coin-buy").modal();
        }

        let transaction = {};
        let orderAmount = 0;

        paypal.Buttons({
            style: {
                layout: "horizontal",
                color: "blue",
                shape: "pill",
            },
            createOrder: async function( data, actions ) {
                transaction = await fetch( `${plushApiUrl}/paypal/request`, {
                    method: "POST",
                    headers: {
                        Twitch: ComfyTwitch.Token
                    },
                    body: JSON.stringify( {
                        coins: orderAmount
                    })
                } ).then( r => r.json() );
                if( !transaction.success ) {
                    toastr.error( "Sorry, there seems to be an error...", "Error", { positionClass:"toast-top-right", containerId:"toast-top-right" } );
                    throw new Error( "Transaction Error" );
                }
                $("#coin-buy").modal("hide");
                return actions.order.create({
                    purchase_units: [{
                        "reference_id": transaction.transactionId,
                        "custom_id": account.key,
                        "description": `PixelPlush Coins Purchase`,
                        "custom": account.key,
                        "amount": {
                            "currency_code": "USD",
                            "value": transaction.usd,
                            "breakdown": {
                                "item_total": {
                                    "value": transaction.usd,
                                    "currency_code": "USD"
                                }
                            }
                        },
                        "items": [
                            {
                                "name": `Plush Coins`,
                                // "sku": "plushcoin",
                                "unit_amount": {
                                    "currency_code": "USD",
                                    "value": transaction.price
                                },
                                "quantity": transaction.coins,
                                "category": "DIGITAL_GOODS"
                            }
                        ]
                    }],
                    "application_context": {
                        "brand_name": "PixelPlush Games",
                        "shipping_preference": "NO_SHIPPING"
                    }
                });
            },
            onApprove: function(data, actions) {
                return actions.order.capture().then(async function(details) {
                    toastr.info( `One moment while we get your Plush Coins...`, "Processing...", { positionClass:"toast-top-right", containerId:"toast-top-right" } );
                    let item = transaction;
                    let itemStatus = await fetch( `${plushApiUrl}/paypal/waiting`, {
                        method: "POST",
                        headers: {
                            Twitch: ComfyTwitch.Token
                        },
                        body: JSON.stringify( {
                            coins: orderAmount,
                            transaction: item.transactionId
                        })
                    } ).then( r => r.json() );
                    if( itemStatus.status !== "pending" ) {
                        console.log( "Status:", itemStatus.status );
                    }
                    let transactionTimer = setInterval( async () => {
                        let result = await fetch( `${plushApiUrl}/transactions/status?id=${item.transactionId}` ).then( r => r.json() );
                        if( result && result.status !== "pending" ) {
                            clearInterval( transactionTimer );
                            if( result.status === "complete" ) {
                                // TODO: thank you celebration!
                                let previousGiftboxes = account.owned.filter( x => x.startsWith( "pet_gift" ) );
                                account = await fetch( `${plushApiUrl}/accounts`, {
                                    headers: {
                                        Twitch: ComfyTwitch.Token
                                    }
                                } ).then( r => r.json() );
                                let newGiftboxes = account.owned.filter( x => x.startsWith( "pet_gift" ) && !previousGiftboxes.includes( x ) );
                                $( ".user-coins" ).text( account.coins );
                                toastr.success( `Plush Coins added!`, "Success", { positionClass:"toast-top-right", containerId:"toast-top-right" } );
                                Swal.fire({
                                    title: "Thank you for the purchase!",
                                    text: `You now have ${account.coins} Plush Coins!`,
                                    type: "success",
                                    confirmButtonClass: 'btn btn-primary',
                                    buttonsStyling: false,
                                }).then( function() {
                                    if( newGiftboxes.length > 0 ) {
                                        setTimeout( () => {
                                            Swal.fire({
                                                title: "PixelPlush Giftbox Bonus!",
                                                text: `You also unlocked Pet ${newGiftboxes.map( x => items[ x ].name).join( ", " )}!`,
                                                imageUrl: `${getItemPreview( newGiftboxes[ 0 ], 0 )}`,
                                                imageWidth: 48,
                                                imageHeight: 48,
                                                animation: false,
                                                customClass: 'animated bounceIn',
                                                confirmButtonClass: 'btn btn-primary',
                                                buttonsStyling: false,
                                            });
                                        }, 500 );
                                    }
                                });
                            }
                            else {
                                // Error message window
                                toastr.error( "There was an error: " + result.error, "Error", { positionClass:"toast-top-right", containerId:"toast-top-right" } );
                            }
                        }
                        else {
                            toastr.warning( `Waiting for confirmation...`, "Processing...", { positionClass:"toast-top-right", containerId:"toast-top-right" } );
                        }
                    }, 5000 );
                });
            }
        }).render('#paypal-button-container');
    </script>

</body>
<!-- END: Body-->

</html>
